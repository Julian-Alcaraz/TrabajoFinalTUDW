<div class="card">
  <span class="card-header">Cargar una nueva consulta de oftalmologia</span>
  <div class="card-body">
    <form (ngSubmit)="enviarFormulario()" [formGroup]="oftalmologiaForm">
      <app-campos-comunes [form]="oftalmologiaForm" (chicoChange)="this.recibirChico($event)" />
      <div class="grid gap-6 md:grid-cols-6 sm:grid-cols-3">
        <!-- Primera Vez
        <div class="mt-4 md:col-span-1">
          <app-input-select-enum label="¿Es la primera vez?" [control]="controlDeInput('primera_vez')"
            idInput="primera_vez" [opciones]="['Si', 'No']" [valores]="['true', 'false']" />
        </div> -->
        <!-- Control
        <div class="mt-4 md:col-span-1">
          <app-input-select-enum label="¿Es un control?" [control]="controlDeInput('control')"
          idInput="control" [opciones]="['Si', 'No']" [valores]="['true', 'false']" />
        </div> -->
        <!-- Calculos primera_vez y control -->
        <ng-container class="mt-4">
          <div *ngIf="chico !== null"
            class="bg-blue-100 border border-blue-300 text-sm p-4 rounded-lg w-full md:col-span-6">
            <p><span class="font-bold">Es su primera vez: </span><span>{{
                this.oftalmologiaForm.get('primera_vez')?.value ? "Si": "No" }}</span></p>
            <p><span class="font-bold">Es control: </span><span>{{ this.oftalmologiaForm.get('control')?.value
                ?"Si": "No" }}</span></p>
          </div>
        </ng-container>
        <!-- Receta -->
        <div class="mt-4 md:col-span-3">
          <app-input-select-enum label="¿Necesita receta?" [control]="controlDeInput('receta')" idInput="receta"
            [opciones]="['Si', 'No']" [valores]="['true', 'false']" />
        </div>
        <!-- Demanda -->
        <div class="mt-4 md:col-span-3">
          <app-input-text label="Motivo de la consulta (demanda)" [control]="controlDeInput('demanda')"
            placeholder="Ej: Padre" idInput="demanda" />
        </div>
        <!-- Derivacion -->
        <div class="mt-4 md:col-span-3">
          <app-input-select-enum label="¿Derivacion externa?" [control]="controlDeInput('derivacion_externa')"
            idInput="derivacion_externa" [opciones]="['Si', 'No']" [valores]="['true', 'false']" />
        </div>
        <!-- Anteojos -->
        <ng-container>
          <div *ngIf="this.oftalmologiaForm.get('control')?.value" class="mt-4 md:col-span-3">
            <app-input-select-enum label="¿Se le entregaron los anteojos?" [control]="controlDeInput('anteojos')"
              idInput="anteojos" [opciones]="['Si', 'No']" [valores]="['true', 'false']" />
          </div>
        </ng-container>
        <!-- Proximo Control -->
        <div class="mt-4 md:col-span-3">
          <p class="block mb-2 text-sm font-medium text-gray-900">Fecha del próximo control</p>
          <mat-form-field class="md:col-span-2">
            <mat-label>Próximo Control</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="prox_control" [min]="fechaManana" />
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-hint
              *ngIf="oftalmologiaForm.get('prox_control')?.errors && (oftalmologiaForm.get('prox_control')?.dirty || oftalmologiaForm.get('prox_control')?.touched) && oftalmologiaForm.get('prox_control')?.errors?.['required']"
              class="text-red-600">El campo es requerido. </mat-hint>
          </mat-form-field>
        </div>
        <!-- Observaciones -->
        <div class="md:col-span-6">
          <app-input-textarea label="Observaciones" [control]="controlDeInput('observaciones')" placeholder=""
            idInput="observaciones" />
        </div>
      </div>
      <!-- Enviar -->
      <div class="flex mt-4">
        <button type="submit" [disabled]="!oftalmologiaForm.valid"
          class="flex my-auto ml-auto text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-3 py-2 text-center -700 -800 disabled:bg-gray-400">Agregar
        </button>
      </div>
    </form>
  </div>
</div>
